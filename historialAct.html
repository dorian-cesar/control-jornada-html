

    <style>
        .contenedor-centrado {
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            margin-top: 20px;
        }

        .contenedor-centrado i {
            margin: 0 10px;
        }

        .contenedor-centrado input,
        .contenedor-centrado button {
            margin: 0 5px;
            padding: 5px;
        }

        .column-id {
            height: 30px !important;
        }
    </style>
</head>
<body>
    <div id="pageHistorialActividades">
        <div style="text-align: center;">
            <h1>Inicio y Termino de Jornada</h1>
        </div>
        <div class="redir" style="margin-left: 30px;">
            <i class="fa fa-arrow-circle-left" onclick="panelControl()"> Atras </i>
        </div>

        <div class="contenedor-centrado">
            <i>Desde:</i>
            <input type="date" class="sel-infoGen" name="inicio" id="fecha-desde">
            <i>&nbsp;Hasta:</i>
            <input type="date" class="sel-infoGen" name="termino" id="fecha-hasta">
            <button class="btnCrear" onclick="filtrarPorFechas()">Buscar</button>
        </div>

        <div class="panelCentralTable">
            <div>
                <button onclick="exportarCSVHAct()" class="btnsub">csv</button>
                <button onclick="excelHAct()" class="btnsub">Excel</button>
                <button onclick="imprimirTablaHAct()" class="btnsub">Imprimir</button>
                <button onclick="copiarHAct()" class="btnsub">Copiar</button>
                <button class="btnCrear" onclick="actualizarTabla2()">Actualizar</button>
            </div>
            <table id="tableHistorialAct" style="width: 100%; margin-top: 20px;">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Nombre</th>
                        <th>Rut</th>
                        <th>Patente</th>
                        <th>Fecha</th>
                        <th>Hora</th>
                        <th>Tipo</th>
                        <th>Método</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
    </div>

    <script>
        $(document).ready(function() {
            // Inicializa DataTables
            var table = $('#tableHistorialAct').DataTable();

            // Función para obtener datos de la API y llenar la tabla
            function cargarDatos() {
                axios.get('https://control-jornada.wit.la/backend-control-jornada/public/api/registros')
                    .then(function(response) {
                        // Limpia la tabla
                        table.clear();
                        
                        // Itera sobre los datos y agrega cada uno a la tabla
                        response.data.forEach(function(registro) {
                            // Extrae la fecha y hora de created_at
                            var fechaHora = new Date(registro.created_at);
                            var fecha = fechaHora.toISOString().split('T')[0];
                            var hora = fechaHora.toTimeString().split(' ')[0];

                            table.row.add([
                                registro.id,
                                registro.conductor,
                                registro.rut,
                                registro.patente,
                                fecha,
                                hora,
                                registro.tipo,
                                registro.metodo
                            ]);
                        });

                        // Dibuja la tabla con los nuevos datos
                        table.draw();
                    })
                    .catch(function(error) {
                        console.error('Error al cargar los datos:', error);
                    });
            }

            // Llama a la función para cargar los datos al iniciar
            cargarDatos();

            // Función de búsqueda por fechas
            window.filtrarPorFechas = function() {
                var fechaDesde = $('#fecha-desde').val();
                var fechaHasta = $('#fecha-hasta').val();

                axios.get('https://control-jornada.wit.la/backend-control-jornada/public/api/eventos-entre-fechas', {
                    params: {
                        start_date: fechaDesde,
                        end_date: fechaHasta
                    }
                })
                .then(function(response) {
                    // Limpia la tabla
                    table.clear();
                    
                    // Itera sobre los datos y agrega cada uno a la tabla
                    response.data.forEach(function(registro) {
                        // Extrae la fecha y hora de created_at
                        var fechaHora = new Date(registro.created_at);
                        var fecha = fechaHora.toISOString().split('T')[0];
                        var hora = fechaHora.toTimeString().split(' ')[0];

                        table.row.add([
                            registro.id,
                            registro.nombre_conductor,
                            registro.rut,
                            registro.patente,
                            fecha,
                            hora,
                            registro.tipo,
                            registro.metodo
                        ]);
                    });

                    // Dibuja la tabla con los nuevos datos
                    table.draw();
                })
                .catch(function(error) {
                    console.error('Error al filtrar los datos:', error);
                });
            }

            // Define la función actualizarTabla2 para recargar los datos
            window.actualizarTabla2 = function() {
                cargarDatos();
            }

            
        });
    </script>
</body>
</html>
